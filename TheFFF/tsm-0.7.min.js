var EPSILON=1E-6,TSM;
(function(l){var d=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(2);a&&(this.xy=a)};Object.defineProperty(d.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});d.prototype.at=function(a){return this.values[a]};d.prototype.reset=function(){this.y=this.x=0};d.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new d);a.x=this.x;a.y=this.y;return a};d.prototype.negate=function(a){"undefined"===typeof a&&(a=null);a||(a=this);a.x=-this.x;a.y=-this.y;return a};d.prototype.equals=function(a,b){"undefined"===typeof b&&(b=EPSILON);return Math.abs(this.x-a.x)>b||Math.abs(this.y-a.y)>b?!1:!0};
d.prototype.length=function(){return Math.sqrt(this.squaredLength())};d.prototype.squaredLength=function(){var a=this.x,b=this.y;return a*a+b*b};d.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};d.prototype.subtract=function(a){this.x-=a.x;this.y-=a.y;return this};d.prototype.multiply=function(a){this.x*=a.x;this.y*=a.y;return this};d.prototype.divide=function(a){this.x/=a.x;this.y/=a.y;return this};d.prototype.scale=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);b.x*=a;
b.y*=a;return b};d.prototype.normalize=function(a){"undefined"===typeof a&&(a=null);a||(a=this);var b=this.length();if(1===b)return this;if(0===b)return a.x=0,a.y=0,a;b=1/b;a.x*=b;a.y*=b;return a};d.prototype.multiplyMat2=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);return a.multiplyVec2(this,b)};d.prototype.multiplyMat3=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);return a.multiplyVec2(this,b)};d.cross=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new l.vec3);
a=a.x*b.y-a.y*b.x;c.x=0;c.y=0;c.z=a;return c};d.dot=function(a,b){return a.x*b.x+a.y*b.y};d.distance=function(a,b){return Math.sqrt(this.squaredDistance(a,b))};d.squaredDistance=function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d};d.direction=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);var h=a.x-b.x,a=a.y-b.y,b=Math.sqrt(h*h+a*a);if(0===b)return c.x=0,c.y=0,c;b=1/b;c.x=h*b;c.y=a*b;return c};d.mix=function(a,b,c,h){"undefined"===typeof h&&(h=null);h||(h=new d);var e=a.x,a=a.y,f=
b.y;h.x=e+c*(b.x-e);h.y=a+c*(f-a);return h};d.sum=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x+b.x;c.y=a.y+b.y;return c};d.difference=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x-b.x;c.y=a.y-b.y;return c};d.product=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x*b.x;c.y=a.y*b.y;return c};d.quotient=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x/b.x;c.y=a.y/b.y;return c};d.zero=new d([0,0]);l.vec2=d})(TSM||
(TSM={}));
(function(l){var d=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(3);a&&(this.xyz=a)};Object.defineProperty(d.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"z",{get:function(){return this.values[2]},set:function(a){this.values[2]=a},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});d.prototype.at=function(a){return this.values[a]};d.prototype.reset=
function(){this.z=this.y=this.x=0};d.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new d);a.x=this.x;a.y=this.y;a.z=this.z;return a};d.prototype.negate=function(a){"undefined"===typeof a&&(a=null);a||(a=this);a.x=-this.x;a.y=-this.y;a.z=-this.z;return a};d.prototype.equals=function(a,b){"undefined"===typeof b&&(b=EPSILON);return Math.abs(this.x-a.x)>b||Math.abs(this.y-a.y)>b||Math.abs(this.z-a.z)>b?!1:!0};d.prototype.length=function(){return Math.sqrt(this.squaredLength())};d.prototype.squaredLength=
function(){var a=this.x,b=this.y,c=this.z;return a*a+b*b+c*c};d.prototype.add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this};d.prototype.subtract=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this};d.prototype.multiply=function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this};d.prototype.divide=function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this};d.prototype.scale=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);b.x*=a;b.y*=a;b.z*=a;return b};d.prototype.normalize=
function(a){"undefined"===typeof a&&(a=null);a||(a=this);var b=this.length();if(1===b)return this;if(0===b)return a.x=0,a.y=0,a.z=0,a;b=1/b;a.x*=b;a.y*=b;a.z*=b;return a};d.prototype.multiplyMat3=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);return a.multiplyVec3(this,b)};d.prototype.multiplyByQuat=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);return a.multiplyVec3(this,b)};d.cross=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);var h=a.x,e=a.y,a=a.z,f=b.x,
g=b.y,b=b.z;c.x=e*b-a*g;c.y=a*f-h*b;c.z=h*g-e*f;return c};d.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};d.distance=function(a,b){return Math.sqrt(this.squaredDistance(a,b))};d.squaredDistance=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=b.z-a.z;return c*c+d*d+e*e};d.direction=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);var h=a.x-b.x,e=a.y-b.y,a=a.z-b.z,b=Math.sqrt(h*h+e*e+a*a);if(0===b)return c.x=0,c.y=0,c.z=0,c;b=1/b;c.x=h*b;c.y=e*b;c.z=a*b;return c};d.mix=function(a,b,c,h){"undefined"===
typeof h&&(h=null);h||(h=new d);h.x=a.x+c*(b.x-a.x);h.y=a.y+c*(b.y-a.y);h.z=a.z+c*(b.z-a.z);return h};d.sum=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x+b.x;c.y=a.y+b.y;c.z=a.z+b.z;return c};d.difference=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x-b.x;c.y=a.y-b.y;c.z=a.z-b.z;return c};d.product=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x*b.x;c.y=a.y*b.y;c.z=a.z*b.z;return c};d.quotient=function(a,b,c){"undefined"===typeof c&&
(c=null);c||(c=new d);c.x=a.x/b.x;c.y=a.y/b.y;c.z=a.z/b.z;return c};d.prototype.toQuat=function(a){"undefined"===typeof a&&(a=null);a||(a=new l.quat);var b=new d,c=new d;b.x=Math.cos(0.5*this.x);c.x=Math.sin(0.5*this.x);b.y=Math.cos(0.5*this.y);c.y=Math.sin(0.5*this.y);b.z=Math.cos(0.5*this.z);c.z=Math.sin(0.5*this.z);a.x=c.x*b.y*b.z-b.x*c.y*c.z;a.y=b.x*c.y*b.z+c.x*b.y*c.z;a.z=b.x*b.y*c.z-c.x*c.y*b.z;a.w=b.x*b.y*b.z+c.x*c.y*c.z;return a};d.zero=new d([0,0,0]);d.up=new d([0,1,0]);d.right=new d([1,
0,0]);d.forward=new d([0,0,1]);l.vec3=d})(TSM||(TSM={}));
(function(l){var d=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(4);a&&(this.xyzw=a)};Object.defineProperty(d.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"z",{get:function(){return this.values[2]},set:function(a){this.values[2]=
a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"w",{get:function(){return this.values[3]},set:function(a){this.values[3]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xyzw",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2];this.values[3]=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"r",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"g",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"b",{get:function(){return this.values[2]},set:function(a){this.values[2]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"a",{get:function(){return this.values[3]},set:function(a){this.values[3]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"rg",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"rgb",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"rgba",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2];this.values[3]=a[3]},enumerable:!0,
configurable:!0});d.prototype.at=function(a){return this.values[a]};d.prototype.reset=function(){this.w=this.z=this.y=this.x=0};d.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new d);a.x=this.x;a.y=this.y;a.z=this.z;a.w=this.w;return a};d.prototype.negate=function(a){"undefined"===typeof a&&(a=null);a||(a=this);a.x=-this.x;a.y=-this.y;a.z=-this.z;a.w=-this.w;return a};d.prototype.equals=function(a,b){"undefined"===typeof b&&(b=EPSILON);return Math.abs(this.x-a.x)>b||Math.abs(this.y-
a.y)>b||Math.abs(this.z-a.z)>b||Math.abs(this.w-a.w)>b?!1:!0};d.prototype.length=function(){return Math.sqrt(this.squaredLength())};d.prototype.squaredLength=function(){var a=this.x,b=this.y,c=this.z,d=this.w;return a*a+b*b+c*c+d*d};d.prototype.add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this};d.prototype.subtract=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this};d.prototype.multiply=function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w;return this};
d.prototype.divide=function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;this.w/=a.w;return this};d.prototype.scale=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);b.x*=a;b.y*=a;b.z*=a;b.w*=a;return b};d.prototype.normalize=function(a){"undefined"===typeof a&&(a=null);a||(a=this);var b=this.length();if(1===b)return this;if(0===b)return a.x*=0,a.y*=0,a.z*=0,a.w*=0,a;b=1/b;a.x*=b;a.y*=b;a.z*=b;a.w*=b;return a};d.prototype.multiplyMat4=function(a,b){"undefined"===typeof b&&(b=null);b||(b=this);
return a.multiplyVec4(this,b)};d.mix=function(a,b,c,h){"undefined"===typeof h&&(h=null);h||(h=new d);h.x=a.x+c*(b.x-a.x);h.y=a.y+c*(b.y-a.y);h.z=a.z+c*(b.z-a.z);h.w=a.w+c*(b.w-a.w);return h};d.sum=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x+b.x;c.y=a.y+b.y;c.z=a.z+b.z;c.w=a.w+b.w;return c};d.difference=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x-b.x;c.y=a.y-b.y;c.z=a.z-b.z;c.w=a.w-b.w;return c};d.product=function(a,b,c){"undefined"===typeof c&&(c=
null);c||(c=new d);c.x=a.x*b.x;c.y=a.y*b.y;c.z=a.z*b.z;c.w=a.w*b.w;return c};d.quotient=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x/b.x;c.y=a.y/b.y;c.z=a.z/b.z;c.w=a.w/b.w;return c};d.zero=new d([0,0,0,1]);l.vec4=d})(TSM||(TSM={}));
(function(l){var d=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(4);a&&this.init(a)};d.prototype.at=function(a){return this.values[a]};d.prototype.init=function(a){for(var b=0;4>b;b++)this.values[b]=a[b];return this};d.prototype.reset=function(){for(var a=0;4>a;a++)this.values[a]=0};d.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new d);for(var b=0;4>b;b++)a.values[b]=this.values[b];return a};d.prototype.all=function(){for(var a=[],b=0;4>b;b++)a[b]=
this.values[b];return a};d.prototype.row=function(a){return[this.values[2*a+0],this.values[2*a+1]]};d.prototype.col=function(a){return[this.values[a],this.values[a+2]]};d.prototype.equals=function(a,b){"undefined"===typeof b&&(b=EPSILON);for(var c=0;4>c;c++)if(Math.abs(this.values[c]-a.at(c))>b)return!1;return!0};d.prototype.determinant=function(){return this.values[0]*this.values[3]-this.values[2]*this.values[1]};d.prototype.setIdentity=function(){this.values[0]=1;this.values[1]=0;this.values[2]=
0;this.values[3]=1;return this};d.prototype.transpose=function(){var a=this.values[1];this.values[1]=this.values[2];this.values[2]=a;return this};d.prototype.inverse=function(){var a=this.determinant();if(!a)return null;a=1/a;this.values[0]=a*this.values[3];this.values[1]=a*-this.values[1];this.values[2]=a*-this.values[2];this.values[3]=a*this.values[0];return this};d.prototype.multiply=function(a){var b=this.values[0],c=this.values[1],d=this.values[2],e=this.values[3];this.values[0]=b*a.at(0)+c*
a.at(2);this.values[1]=b*a.at(1)+c*a.at(3);this.values[2]=d*a.at(0)+e*a.at(2);this.values[3]=d*a.at(1)+e*a.at(3);return this};d.prototype.rotate=function(a){var b=this.values[0],c=this.values[1],d=this.values[2],e=this.values[3],f=Math.sin(a),a=Math.cos(a);this.values[0]=b*a+c*f;this.values[1]=b*-f+c*a;this.values[2]=d*a+e*f;this.values[3]=d*-f+e*a;return this};d.prototype.multiplyVec2=function(a,b){"undefined"===typeof b&&(b=null);var c=a.x,d=a.y;return b?(b.xy=[c*this.values[0]+d*this.values[1],
c*this.values[2]+d*this.values[3]],b):new l.vec2([c*this.values[0]+d*this.values[1],c*this.values[2]+d*this.values[3]])};d.prototype.scale=function(a){var b=this.values[1],c=this.values[2],d=this.values[3],e=a.x,a=a.y;this.values[0]*=e;this.values[1]=b*a;this.values[2]=c*e;this.values[3]=d*a;return this};d.product=function(a,b,c){"undefined"===typeof c&&(c=null);var h=a.at(0),e=a.at(1),f=a.at(2),a=a.at(3);return c?(c.init([h*b.at(0)+e*b.at(2),h*b.at(1)+e*b.at(3),f*b.at(0)+a*b.at(2),f*b.at(1)+a*b.at(3)]),
c):new d([h*b.at(0)+e*b.at(2),h*b.at(1)+e*b.at(3),f*b.at(0)+a*b.at(2),f*b.at(1)+a*b.at(3)])};d.identity=(new d).setIdentity();l.mat2=d})(TSM||(TSM={}));
(function(l){var d=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(9);a&&this.init(a)};d.prototype.at=function(a){return this.values[a]};d.prototype.init=function(a){for(var b=0;9>b;b++)this.values[b]=a[b];return this};d.prototype.reset=function(){for(var a=0;9>a;a++)this.values[a]=0};d.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new d);for(var b=0;9>b;b++)a.values[b]=this.values[b];return a};d.prototype.all=function(){for(var a=[],b=0;9>b;b++)a[b]=
this.values[b];return a};d.prototype.row=function(a){return[this.values[3*a+0],this.values[3*a+1],this.values[3*a+2]]};d.prototype.col=function(a){return[this.values[a],this.values[a+3],this.values[a+6]]};d.prototype.equals=function(a,b){"undefined"===typeof b&&(b=EPSILON);for(var c=0;9>c;c++)if(Math.abs(this.values[c]-a.at(c))>b)return!1;return!0};d.prototype.determinant=function(){var a=this.values[3],b=this.values[4],c=this.values[5],d=this.values[6],e=this.values[7],f=this.values[8];return this.values[0]*
(f*b-c*e)+this.values[1]*(-f*a+c*d)+this.values[2]*(e*a-b*d)};d.prototype.setIdentity=function(){this.values[0]=1;this.values[1]=0;this.values[2]=0;this.values[3]=0;this.values[4]=1;this.values[5]=0;this.values[6]=0;this.values[7]=0;this.values[8]=1;return this};d.prototype.transpose=function(){var a=this.values[1],b=this.values[2],c=this.values[5];this.values[1]=this.values[3];this.values[2]=this.values[6];this.values[3]=a;this.values[5]=this.values[7];this.values[6]=b;this.values[7]=c;return this};
d.prototype.inverse=function(){var a=this.values[0],b=this.values[1],c=this.values[2],d=this.values[3],e=this.values[4],f=this.values[5],g=this.values[6],j=this.values[7],i=this.values[8],p=i*e-f*j,k=-i*d+f*g,m=j*d-e*g,n=a*p+b*k+c*m;if(!n)return null;n=1/n;this.values[0]=p*n;this.values[1]=(-i*b+c*j)*n;this.values[2]=(f*b-c*e)*n;this.values[3]=k*n;this.values[4]=(i*a-c*g)*n;this.values[5]=(-f*a+c*d)*n;this.values[6]=m*n;this.values[7]=(-j*a+b*g)*n;this.values[8]=(e*a-b*d)*n;return this};d.prototype.multiply=
function(a){var b=this.values[0],c=this.values[1],d=this.values[2],e=this.values[3],f=this.values[4],g=this.values[5],j=this.values[6],i=this.values[7],p=this.values[8],k=a.at(0),m=a.at(1),n=a.at(2),E=a.at(3),s=a.at(4),t=a.at(5),w=a.at(6),q=a.at(7),a=a.at(8);this.values[0]=k*b+m*e+n*j;this.values[1]=k*c+m*f+n*i;this.values[2]=k*d+m*g+n*p;this.values[3]=E*b+s*e+t*j;this.values[4]=E*c+s*f+t*i;this.values[5]=E*d+s*g+t*p;this.values[6]=w*b+q*e+a*j;this.values[7]=w*c+q*f+a*i;this.values[8]=w*d+q*g+a*p;
return this};d.prototype.multiplyVec2=function(a,b){"undefined"===typeof b&&(b=null);var c=a.x,d=a.y;return b?(b.xy=[c*this.values[0]+d*this.values[3]+this.values[6],c*this.values[1]+d*this.values[4]+this.values[7]],b):new l.vec2([c*this.values[0]+d*this.values[3]+this.values[6],c*this.values[1]+d*this.values[4]+this.values[7]])};d.prototype.multiplyVec3=function(a,b){"undefined"===typeof b&&(b=null);var c=a.x,d=a.y,e=a.z;return b?(b.xyz=[c*this.values[0]+d*this.values[3]+e*this.values[6],c*this.values[1]+
d*this.values[4]+e*this.values[7],c*this.values[2]+d*this.values[5]+e*this.values[8]],b):new l.vec3([c*this.values[0]+d*this.values[3]+e*this.values[6],c*this.values[1]+d*this.values[4]+e*this.values[7],c*this.values[2]+d*this.values[5]+e*this.values[8]])};d.prototype.toMat4=function(a){"undefined"===typeof a&&(a=null);return a?(a.init([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1]),a):new l.mat4([this.values[0],
this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1])};d.prototype.toQuat=function(){var a=this.values[0],b=this.values[1],c=this.values[2],d=this.values[3],e=this.values[4],f=this.values[5],g=this.values[6],j=this.values[7],i=this.values[8],p=a-e-i,k=e-a-i,m=i-a-e,n=0,a=a+e+i;p>a&&(a=p,n=1);k>a&&(a=k,n=2);m>a&&(a=m,n=3);p=0.5*Math.sqrt(a+1);k=0.25/p;m=new l.quat;switch(n){case 0:m.w=p;m.x=(f-j)*k;m.y=(g-c)*k;m.z=(b-
d)*k;break;case 1:m.w=(f-j)*k;m.x=p;m.y=(b+d)*k;m.z=(g+c)*k;break;case 2:m.w=(g-c)*k;m.x=(b+d)*k;m.y=p;m.z=(f+j)*k;break;case 3:m.w=(b-d)*k,m.x=(g+c)*k,m.y=(f+j)*k,m.z=p}return m};d.prototype.rotate=function(a,b){var c=b.x,d=b.y,e=b.z,f=Math.sqrt(c*c+d*d+e*e);if(!f)return null;1!==f&&(f=1/f,c*=f,d*=f,e*=f);var g=Math.sin(a),j=Math.cos(a),i=1-j,f=this.values[0],p=this.values[1],k=this.values[2],m=this.values[4],n=this.values[5],E=this.values[6],s=this.values[8],t=this.values[9],w=this.values[10],q=
c*c*i+j,r=d*c*i+e*g,v=e*c*i-d*g,u=c*d*i-e*g,l=d*d*i+j,y=e*d*i+c*g,z=c*e*i+d*g,c=d*e*i-c*g,e=e*e*i+j;this.values[0]=f*q+m*r+s*v;this.values[1]=p*q+n*r+t*v;this.values[2]=k*q+E*r+w*v;this.values[3]=f*u+m*l+s*y;this.values[4]=p*u+n*l+t*y;this.values[5]=k*u+E*l+w*y;this.values[6]=f*z+m*c+s*e;this.values[7]=p*z+n*c+t*e;this.values[8]=k*z+E*c+w*e;return this};d.product=function(a,b,c){"undefined"===typeof c&&(c=null);var h=a.at(0),e=a.at(1),f=a.at(2),g=a.at(3),j=a.at(4),i=a.at(5),p=a.at(6),k=a.at(7),a=
a.at(8),m=b.at(0),n=b.at(1),E=b.at(2),s=b.at(3),t=b.at(4),l=b.at(5),q=b.at(6),r=b.at(7),b=b.at(8);return c?(c.init([m*h+n*g+E*p,m*e+n*j+E*k,m*f+n*i+E*a,s*h+t*g+l*p,s*e+t*j+l*k,s*f+t*i+l*a,q*h+r*g+b*p,q*e+r*j+b*k,q*f+r*i+b*a]),c):new d([m*h+n*g+E*p,m*e+n*j+E*k,m*f+n*i+E*a,s*h+t*g+l*p,s*e+t*j+l*k,s*f+t*i+l*a,q*h+r*g+b*p,q*e+r*j+b*k,q*f+r*i+b*a])};d.identity=(new d).setIdentity();l.mat3=d})(TSM||(TSM={}));
(function(l){var d=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(16);a&&this.init(a)};d.prototype.at=function(a){return this.values[a]};d.prototype.init=function(a){for(var b=0;16>b;b++)this.values[b]=a[b];return this};d.prototype.reset=function(){for(var a=0;16>a;a++)this.values[a]=0};d.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new d);for(var b=0;16>b;b++)a.values[b]=this.values[b];return a};d.prototype.all=function(){for(var a=[],b=0;16>b;b++)a[b]=
this.values[b];return a};d.prototype.row=function(a){return[this.values[4*a+0],this.values[4*a+1],this.values[4*a+2],this.values[4*a+3]]};d.prototype.col=function(a){return[this.values[a],this.values[a+4],this.values[a+8],this.values[a+12]]};d.prototype.equals=function(a,b){"undefined"===typeof b&&(b=EPSILON);for(var c=0;16>c;c++)if(Math.abs(this.values[c]-a.at(c))>b)return!1;return!0};d.prototype.determinant=function(){var a=this.values[0],b=this.values[1],c=this.values[2],d=this.values[3],e=this.values[4],
f=this.values[5],g=this.values[6],j=this.values[7],i=this.values[8],p=this.values[9],k=this.values[10],m=this.values[11],n=this.values[12],l=this.values[13],s=this.values[14],t=this.values[15];return(a*f-b*e)*(k*t-m*s)-(a*g-c*e)*(p*t-m*l)+(a*j-d*e)*(p*s-k*l)+(b*g-c*f)*(i*t-m*n)-(b*j-d*f)*(i*s-k*n)+(c*j-d*g)*(i*l-p*n)};d.prototype.setIdentity=function(){this.values[0]=1;this.values[1]=0;this.values[2]=0;this.values[3]=0;this.values[4]=0;this.values[5]=1;this.values[6]=0;this.values[7]=0;this.values[8]=
0;this.values[9]=0;this.values[10]=1;this.values[11]=0;this.values[12]=0;this.values[13]=0;this.values[14]=0;this.values[15]=1;return this};d.prototype.transpose=function(){var a=this.values[1],b=this.values[2],c=this.values[3],d=this.values[6],e=this.values[7],f=this.values[11];this.values[1]=this.values[4];this.values[2]=this.values[8];this.values[3]=this.values[12];this.values[4]=a;this.values[6]=this.values[9];this.values[7]=this.values[13];this.values[8]=b;this.values[9]=d;this.values[11]=this.values[14];
this.values[12]=c;this.values[13]=e;this.values[14]=f;return this};d.prototype.inverse=function(){var a=this.values[0],b=this.values[1],c=this.values[2],d=this.values[3],e=this.values[4],f=this.values[5],g=this.values[6],j=this.values[7],i=this.values[8],p=this.values[9],k=this.values[10],m=this.values[11],n=this.values[12],l=this.values[13],s=this.values[14],t=this.values[15],w=a*f-b*e,q=a*g-c*e,r=a*j-d*e,v=b*g-c*f,u=b*j-d*f,A=c*j-d*g,y=i*l-p*n,z=i*s-k*n,B=i*t-m*n,C=p*s-k*l,D=p*t-m*l,F=k*t-m*s,x=
w*F-q*D+r*C+v*B-u*z+A*y;if(!x)return null;x=1/x;this.values[0]=(f*F-g*D+j*C)*x;this.values[1]=(-b*F+c*D-d*C)*x;this.values[2]=(l*A-s*u+t*v)*x;this.values[3]=(-p*A+k*u-m*v)*x;this.values[4]=(-e*F+g*B-j*z)*x;this.values[5]=(a*F-c*B+d*z)*x;this.values[6]=(-n*A+s*r-t*q)*x;this.values[7]=(i*A-k*r+m*q)*x;this.values[8]=(e*D-f*B+j*y)*x;this.values[9]=(-a*D+b*B-d*y)*x;this.values[10]=(n*u-l*r+t*w)*x;this.values[11]=(-i*u+p*r-m*w)*x;this.values[12]=(-e*C+f*z-g*y)*x;this.values[13]=(a*C-b*z+c*y)*x;this.values[14]=
(-n*v+l*q-s*w)*x;this.values[15]=(i*v-p*q+k*w)*x;return this};d.prototype.multiply=function(a){var b=this.values[0],c=this.values[1],d=this.values[2],e=this.values[3],f=this.values[4],g=this.values[5],j=this.values[6],i=this.values[7],p=this.values[8],k=this.values[9],m=this.values[10],n=this.values[11],l=this.values[12],s=this.values[13],t=this.values[14],w=this.values[15],q=a.at(0),r=a.at(1),v=a.at(2),u=a.at(3);this.values[0]=q*b+r*f+v*p+u*l;this.values[1]=q*c+r*g+v*k+u*s;this.values[2]=q*d+r*j+
v*m+u*t;this.values[3]=q*e+r*i+v*n+u*w;q=a.at(4);r=a.at(5);v=a.at(6);u=a.at(7);this.values[4]=q*b+r*f+v*p+u*l;this.values[5]=q*c+r*g+v*k+u*s;this.values[6]=q*d+r*j+v*m+u*t;this.values[7]=q*e+r*i+v*n+u*w;q=a.at(8);r=a.at(9);v=a.at(10);u=a.at(11);this.values[8]=q*b+r*f+v*p+u*l;this.values[9]=q*c+r*g+v*k+u*s;this.values[10]=q*d+r*j+v*m+u*t;this.values[11]=q*e+r*i+v*n+u*w;q=a.at(12);r=a.at(13);v=a.at(14);u=a.at(15);this.values[12]=q*b+r*f+v*p+u*l;this.values[13]=q*c+r*g+v*k+u*s;this.values[14]=q*d+r*
j+v*m+u*t;this.values[15]=q*e+r*i+v*n+u*w;return this};d.prototype.multiplyVec3=function(a){var b=a.x,c=a.y,a=a.z;return new l.vec3([this.values[0]*b+this.values[4]*c+this.values[8]*a+this.values[12],this.values[1]*b+this.values[5]*c+this.values[9]*a+this.values[13],this.values[2]*b+this.values[6]*c+this.values[10]*a+this.values[14]])};d.prototype.multiplyVec4=function(a,b){"undefined"===typeof b&&(b=null);b||(b=new l.vec4);var c=a.x,d=a.y,e=a.z,f=a.w;b.x=this.values[0]*c+this.values[4]*d+this.values[8]*
e+this.values[12]*f;b.y=this.values[1]*c+this.values[5]*d+this.values[9]*e+this.values[13]*f;b.z=this.values[2]*c+this.values[6]*d+this.values[10]*e+this.values[14]*f;b.w=this.values[3]*c+this.values[7]*d+this.values[11]*e+this.values[15]*f;return b};d.prototype.toMat3=function(){return new l.mat3([this.values[0],this.values[1],this.values[2],this.values[4],this.values[5],this.values[6],this.values[8],this.values[9],this.values[10]])};d.prototype.toInverseMat3=function(){var a=this.values[0],b=this.values[1],
c=this.values[2],d=this.values[4],e=this.values[5],f=this.values[6],g=this.values[8],j=this.values[9],i=this.values[10],p=i*e-f*j,k=-i*d+f*g,m=j*d-e*g,n=a*p+b*k+c*m;if(!n)return null;n=1/n;return new l.mat3([p*n,(-i*b+c*j)*n,(f*b-c*e)*n,k*n,(i*a-c*g)*n,(-f*a+c*d)*n,m*n,(-j*a+b*g)*n,(e*a-b*d)*n])};d.prototype.translate=function(a){var b=a.x,c=a.y,a=a.z;this.values[12]+=this.values[0]*b+this.values[4]*c+this.values[8]*a;this.values[13]+=this.values[1]*b+this.values[5]*c+this.values[9]*a;this.values[14]+=
this.values[2]*b+this.values[6]*c+this.values[10]*a;this.values[15]+=this.values[3]*b+this.values[7]*c+this.values[11]*a;return this};d.prototype.scale=function(a){var b=a.x,c=a.y,a=a.z;this.values[0]*=b;this.values[1]*=b;this.values[2]*=b;this.values[3]*=b;this.values[4]*=c;this.values[5]*=c;this.values[6]*=c;this.values[7]*=c;this.values[8]*=a;this.values[9]*=a;this.values[10]*=a;this.values[11]*=a;return this};d.prototype.rotate=function(a,b){var c=b.x,d=b.y,e=b.z,f=Math.sqrt(c*c+d*d+e*e);if(!f)return null;
1!==f&&(f=1/f,c*=f,d*=f,e*=f);var g=Math.sin(a),j=Math.cos(a),i=1-j,f=this.values[0],p=this.values[1],k=this.values[2],m=this.values[3],n=this.values[4],l=this.values[5],s=this.values[6],t=this.values[7],w=this.values[8],q=this.values[9],r=this.values[10],v=this.values[11],u=c*c*i+j,A=d*c*i+e*g,y=e*c*i-d*g,z=c*d*i-e*g,B=d*d*i+j,C=e*d*i+c*g,D=c*e*i+d*g,c=d*e*i-c*g,e=e*e*i+j;this.values[0]=f*u+n*A+w*y;this.values[1]=p*u+l*A+q*y;this.values[2]=k*u+s*A+r*y;this.values[3]=m*u+t*A+v*y;this.values[4]=f*
z+n*B+w*C;this.values[5]=p*z+l*B+q*C;this.values[6]=k*z+s*B+r*C;this.values[7]=m*z+t*B+v*C;this.values[8]=f*D+n*c+w*e;this.values[9]=p*D+l*c+q*e;this.values[10]=k*D+s*c+r*e;this.values[11]=m*D+t*c+v*e;return this};d.frustum=function(a,b,c,h,e,f){var g=b-a,j=h-c,i=f-e;return new d([2*e/g,0,0,0,0,2*e/j,0,0,(b+a)/g,(h+c)/j,-(f+e)/i,-1,0,0,-(2*f*e)/i,0])};d.perspective=function(a,b,c,h){a=c*Math.tan(a*Math.PI/360);b*=a;return d.frustum(-b,b,-a,a,c,h)};d.orthographic=function(a,b,c,h,e,f){var g=b-a,j=
h-c,i=f-e;return new d([2/g,0,0,0,0,2/j,0,0,0,0,-2/i,0,-(a+b)/g,-(h+c)/j,-(f+e)/i,1])};d.lookAt=function(a,b,c){"undefined"===typeof c&&(c=l.vec3.up);if(a.equals(b))return this.identity;var b=l.vec3.difference(a,b).normalize(),c=l.vec3.cross(c,b).normalize(),h=l.vec3.cross(b,c).normalize();return new d([c.x,h.x,b.x,0,c.y,h.y,b.y,0,c.z,h.z,b.z,0,-l.vec3.dot(c,a),-l.vec3.dot(h,a),-l.vec3.dot(b,a),1])};d.product=function(a,b,c){"undefined"===typeof c&&(c=null);var h=a.at(0),e=a.at(1),f=a.at(2),g=a.at(3),
j=a.at(4),i=a.at(5),p=a.at(6),k=a.at(7),m=a.at(8),n=a.at(9),l=a.at(10),s=a.at(11),t=a.at(12),w=a.at(13),q=a.at(14),a=a.at(15),r=b.at(0),v=b.at(1),u=b.at(2),A=b.at(3),y=b.at(4),z=b.at(5),B=b.at(6),C=b.at(7),D=b.at(8),F=b.at(9),x=b.at(10),G=b.at(11),H=b.at(12),I=b.at(13),J=b.at(14),b=b.at(15);return c?(c.init([r*h+v*j+u*m+A*t,r*e+v*i+u*n+A*w,r*f+v*p+u*l+A*q,r*g+v*k+u*s+A*a,y*h+z*j+B*m+C*t,y*e+z*i+B*n+C*w,y*f+z*p+B*l+C*q,y*g+z*k+B*s+C*a,D*h+F*j+x*m+G*t,D*e+F*i+x*n+G*w,D*f+F*p+x*l+G*q,D*g+F*k+x*s+G*a,
H*h+I*j+J*m+b*t,H*e+I*i+J*n+b*w,H*f+I*p+J*l+b*q,H*g+I*k+J*s+b*a]),c):new d([r*h+v*j+u*m+A*t,r*e+v*i+u*n+A*w,r*f+v*p+u*l+A*q,r*g+v*k+u*s+A*a,y*h+z*j+B*m+C*t,y*e+z*i+B*n+C*w,y*f+z*p+B*l+C*q,y*g+z*k+B*s+C*a,D*h+F*j+x*m+G*t,D*e+F*i+x*n+G*w,D*f+F*p+x*l+G*q,D*g+F*k+x*s+G*a,H*h+I*j+J*m+b*t,H*e+I*i+J*n+b*w,H*f+I*p+J*l+b*q,H*g+I*k+J*s+b*a])};d.identity=(new d).setIdentity();l.mat4=d})(TSM||(TSM={}));
(function(l){var d=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(4);a&&(this.xyzw=a)};Object.defineProperty(d.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"z",{get:function(){return this.values[2]},set:function(a){this.values[2]=
a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"w",{get:function(){return this.values[3]},set:function(a){this.values[3]=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"xyzw",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2];this.values[3]=a[3]},enumerable:!0,configurable:!0});d.prototype.at=function(a){return this.values[a]};d.prototype.reset=function(){for(var a=0;4>a;a++)this.values[a]=0};d.prototype.copy=function(a){"undefined"===typeof a&&
(a=null);a||(a=new d);for(var b=0;4>b;b++)a.values[b]=this.values[b];return a};d.prototype.roll=function(){var a=this.x,b=this.y,c=this.z,d=this.w;return Math.atan2(2*(a*b+d*c),d*d+a*a-b*b-c*c)};d.prototype.pitch=function(){var a=this.x,b=this.y,c=this.z,d=this.w;return Math.atan2(2*(b*c+d*a),d*d-a*a-b*b+c*c)};d.prototype.yaw=function(){return Math.asin(2*(this.x*this.z-this.w*this.y))};d.prototype.equals=function(a,b){"undefined"===typeof b&&(b=EPSILON);for(var c=0;4>c;c++)if(Math.abs(this.values[c]-
a.at(c))>b)return!1;return!0};d.prototype.setIdentity=function(){this.z=this.y=this.x=0;this.w=1;return this};d.prototype.calculateW=function(){var a=this.x,b=this.y,c=this.z;this.w=-Math.sqrt(Math.abs(1-a*a-b*b-c*c));return this};d.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w};d.prototype.inverse=function(){var a=d.dot(this,this);if(!a)return this.xyzw=[0,0,0,0],this;a=a?1/a:0;this.x*=-a;this.y*=-a;this.z*=-a;this.w*=a;return this};d.prototype.conjugate=function(){this.values[0]*=-1;
this.values[1]*=-1;this.values[2]*=-1;return this};d.prototype.length=function(){var a=this.x,b=this.y,c=this.z,d=this.w;return Math.sqrt(a*a+b*b+c*c+d*d)};d.prototype.normalize=function(a){"undefined"===typeof a&&(a=null);a||(a=this);var b=this.x,c=this.y,d=this.z,e=this.w,f=Math.sqrt(b*b+c*c+d*d+e*e);if(!f)return a.x=0,a.y=0,a.z=0,a.w=0,a;f=1/f;a.x=b*f;a.y=c*f;a.z=d*f;a.w=e*f;return a};d.prototype.add=function(a){for(var b=0;4>b;b++)this.values[b]+=a.at(b);return this};d.prototype.multiply=function(a){var b=
this.values[0],c=this.values[1],d=this.values[2],e=this.values[3],f=a.x,g=a.y,j=a.z,a=a.w;this.x=b*a+e*f+c*j-d*g;this.y=c*a+e*g+d*f-b*j;this.z=d*a+e*j+b*g-c*f;this.w=e*a-b*f-c*g-d*j;return this};d.prototype.multiplyVec3=function(a,b){"undefined"===typeof b&&(b=null);b||(b=new l.vec3);var c=a.x,d=a.y,e=a.z,f=this.x,g=this.y,j=this.z,i=this.w,p=i*c+g*e-j*d,k=i*d+j*c-f*e,m=i*e+f*d-g*c,c=-f*c-g*d-j*e;b.x=p*i+c*-f+k*-j-m*-g;b.y=k*i+c*-g+m*-f-p*-j;b.z=m*i+c*-j+p*-g-k*-f;return b};d.prototype.toMat3=function(a){"undefined"===
typeof a&&(a=null);a||(a=new l.mat3);var b=this.x,c=this.y,d=this.z,e=this.w,f=b+b,g=c+c,j=d+d,i=b*f,p=b*g,b=b*j,k=c*g,c=c*j,d=d*j,f=e*f,g=e*g,e=e*j;a.init([1-(k+d),p+e,b-g,p-e,1-(i+d),c+f,b+g,c-f,1-(i+k)]);return a};d.prototype.toMat4=function(a){"undefined"===typeof a&&(a=null);a||(a=new l.mat4);var b=this.x,c=this.y,d=this.z,e=this.w,f=b+b,g=c+c,j=d+d,i=b*f,p=b*g,b=b*j,k=c*g,c=c*j,d=d*j,f=e*f,g=e*g,e=e*j;a.init([1-(k+d),p+e,b-g,0,p-e,1-(i+d),c+f,0,b+g,c-f,1-(i+k),0,0,0,0,1]);return a};d.sum=function(a,
b,c){"undefined"===typeof c&&(c=null);c||(c=new d);c.x=a.x+b.x;c.y=a.y+b.y;c.z=a.z+b.z;c.w=a.w+b.w;return c};d.product=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);var h=a.x,e=a.y,f=a.z,a=a.w,g=b.x,j=b.y,i=b.z,b=b.w;c.x=h*b+a*g+e*i-f*j;c.y=e*b+a*j+f*g-h*i;c.z=f*b+a*i+h*j-e*g;c.w=a*b-h*g-e*j-f*i;return c};d.cross=function(a,b,c){"undefined"===typeof c&&(c=null);c||(c=new d);var h=a.x,e=a.y,f=a.z,a=a.w,g=b.x,j=b.y,i=b.z,b=b.w;c.x=a*i+f*b+h*j-e*g;c.y=a*b-h*g-e*j-f*i;c.z=a*g+h*b+e*i-
f*j;c.w=a*j+e*b+f*g-h*i;return c};d.shortMix=function(a,b,c,h){"undefined"===typeof h&&(h=null);h||(h=new d);if(0>=c)return h.xyzw=a.xyzw,h;if(1<=c)return h.xyzw=b.xyzw,h;var e=d.dot(a,b),b=b.copy();0>e&&(b.inverse(),e=-e);if(0.9999<e)e=1-c,c=0+c;else var f=Math.sqrt(1-e*e),g=Math.atan2(f,e),f=1/f,e=Math.sin((1-c)*g)*f,c=Math.sin((0+c)*g)*f;h.x=e*a.x+c*b.x;h.y=e*a.y+c*b.y;h.z=e*a.z+c*b.z;h.w=e*a.w+c*b.w;return h};d.mix=function(a,b,c,h){"undefined"===typeof h&&(h=null);h||(h=new d);var e=a.x*b.x+
a.y*b.y+a.z*b.z+a.w*b.w;if(1<=Math.abs(e))return h.xyzw=a.xyzw,h;var f=Math.acos(e),g=Math.sqrt(1-e*e);if(0.001>Math.abs(g))return h.x=0.5*a.x+0.5*b.x,h.y=0.5*a.y+0.5*b.y,h.z=0.5*a.z+0.5*b.z,h.w=0.5*a.w+0.5*b.w,h;e=Math.sin((1-c)*f)/g;c=Math.sin(c*f)/g;h.x=a.x*e+b.x*c;h.y=a.y*e+b.y*c;h.z=a.z*e+b.z*c;h.w=a.w*e+b.w*c;return h};d.identity=(new d).setIdentity();l.quat=d})(TSM||(TSM={}));
